<head>
  <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
  <style>
    /* CSS styles here */
  </style>
</head>
<main>
  <h1>URL Shortener</h1>
  <form id="post-form">
    {% csrf_token %}
    <input type="text" name="link" id="link" placeholder="Enter URL here">
    <div class="buttons">
      <button type="submit" id="shorten">Shorten</button>
    </div>
  </form>

  <section id="section">
    <h2></h2>
  </section>
</main>

<script type="text/javascript">
  $(document).ready(function () {
  $('#post-form').on('submit', function (e) {
    e.preventDefault(); // Prevent the default form submission behavior

    var form = $(this);
    var button = form.find('#shorten');
    button.prop('disabled', true); // Disable the button to prevent multiple submissions

    $.ajax({
      type: 'POST',
      url: '/create',
      data: {
        link: $('#link').val(),
        csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val(),
      },
      success: function (data) {
        // Clear the input field
        $('#link').val('');

        // Create a new URL element
        var newURL = $('<p>').text("Shortened URL: localhost:8000/" + data);

        // Append the new URL element to the section
        $('#section').append(newURL);

        button.prop('disabled', false); // Re-enable the button after receiving the response
      },
      error: function (xhr, status, error) {
        console.error("AJAX Error: " + status + "\n" + error);
        button.prop('disabled', false); // Re-enable the button in case of an error
      }
    });
  });
});



</script>
